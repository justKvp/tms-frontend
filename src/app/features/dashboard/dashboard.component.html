<div class="habr-container">
  <div class="habr-header">
    <h1>Dashboard</h1>
    <p>–û–±–∑–æ—Ä —Å–∏—Å—Ç–µ–º—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–∞–¥–∞—á–∞–º–∏</p>
  </div>

  <!-- –ö–Ω–æ–ø–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è -->
  <div style="display: flex; justify-content: flex-end; margin-bottom: 20px;">
    <button class="habr-btn habr-btn-primary" (click)="refresh()" [disabled]="isLoading">
      {{ isLoading ? '–ó–∞–≥—Ä—É–∑–∫–∞...' : '–û–±–Ω–æ–≤–∏—Ç—å' }}
    </button>
  </div>

  <div class="habr-main">
    <!-- –°–æ—Å—Ç–æ—è–Ω–∏–µ –∑–∞–≥—Ä—É–∑–∫–∏ -->
    @if (isLoading) {
      <div class="loading">
        <p>–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö...</p>
      </div>
    }

    <!-- –û—à–∏–±–∫–∞ -->
    @if (hasError && !isLoading) {
      <div class="error">
        <p>–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —Å–µ—Ä–≤–µ—Ä—É.</p>
      </div>
    }

    <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
    @if (!isLoading && !hasError) {
      <div class="stats-grid">
        <div class="stat-card">
          <div class="stat-icon blue">üìä</div>
          <div class="stat-content">
            <h3>{{ stats.projects }}</h3>
            <p>–ü—Ä–æ–µ–∫—Ç–æ–≤</p>
          </div>
        </div>

        <div class="stat-card">
          <div class="stat-icon green">‚úÖ</div>
          <div class="stat-content">
            <h3>{{ stats.tasks }}</h3>
            <p>–í—Å–µ–≥–æ –∑–∞–¥–∞—á</p>
          </div>
        </div>

        <div class="stat-card">
          <div class="stat-icon orange">üë•</div>
          <div class="stat-content">
            <h3>{{ stats.users }}</h3>
            <p>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</p>
          </div>
        </div>

        <div class="stat-card">
          <div class="stat-icon red">‚è≥</div>
          <div class="stat-content">
            <h3>{{ stats.openTasks }}</h3>
            <p>–û—Ç–∫—Ä—ã—Ç—ã—Ö –∑–∞–¥–∞—á</p>
          </div>
        </div>
      </div>
    }

    <!-- –ü–æ—Å–ª–µ–¥–Ω–∏–µ –∑–∞–¥–∞—á–∏ -->
    @if (!isLoading && !hasError) {
      <div class="section">
        <div class="section-header">
          <h2>–ü–æ—Å–ª–µ–¥–Ω–∏–µ –∑–∞–¥–∞—á–∏</h2>
          <a routerLink="/tasks" class="habr-link">–í—Å–µ –∑–∞–¥–∞—á–∏ ‚Üí</a>
        </div>

        <div class="cards-grid">
          @for (task of recentTasks; track task.id) {
            <div class="habr-card">
              <div class="card-header">
                <span class="task-status" [class]="getStatusColor(task.status)">
                  {{ task.status | uppercase }}
                </span>
                <span class="task-priority" [class]="getPriorityColor(task.priority)">
                  {{ task.priority | uppercase }}
                </span>
              </div>
              <h4>{{ task.title }}</h4>
              <p class="card-description">{{ task.description || '–ù–µ—Ç –æ–ø–∏—Å–∞–Ω–∏—è' }}</p>
              <div class="card-footer">
                <small>–°—Ä–æ–∫: {{ task.dueDate ? (task.dueDate | date: 'dd.MM.yyyy') : '–ù–µ —É–∫–∞–∑–∞–Ω' }}</small>
                <small>–ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å: {{ task.assigneeId || '–ù–µ –Ω–∞–∑–Ω–∞—á–µ–Ω' }}</small>
              </div>
            </div>
          } @empty {
            <div class="empty-state">
              <p>–ó–∞–¥–∞—á–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</p>
            </div>
          }
        </div>
      </div>
    }

    <!-- –ü–æ—Å–ª–µ–¥–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç—ã -->
    @if (!isLoading && !hasError) {
      <div class="section">
        <div class="section-header">
          <h2>–ü–æ—Å–ª–µ–¥–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç—ã</h2>
          <a routerLink="/projects" class="habr-link">–í—Å–µ –ø—Ä–æ–µ–∫—Ç—ã ‚Üí</a>
        </div>

        <div class="cards-grid">
          @for (project of recentProjects; track project.id) {
            <div class="habr-card">
              <div class="card-header">
                <span class="project-status" [class]="getStatusColor(project.status)">
                  {{ project.status | uppercase }}
                </span>
              </div>
              <h4>{{ project.name }}</h4>
              <p class="card-description">{{ project.description || '–ù–µ—Ç –æ–ø–∏—Å–∞–Ω–∏—è' }}</p>
              <div class="card-footer">
                <small>–°–æ–∑–¥–∞–Ω: {{ project.createdAt | date: 'dd.MM.yyyy' }}</small>
              </div>
            </div>
          } @empty {
            <div class="empty-state">
              <p>–ü—Ä–æ–µ–∫—Ç—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</p>
            </div>
          }
        </div>
      </div>
    }
  </div>
</div>
